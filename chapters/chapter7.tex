\chapter{Conclusions}\label{conclusions}
The success of Mu2e depends on many factors, one of which is the performance of the tracker. 
The tracker must provide excellent momentum resolution, approximately 1 MeV/c, 
in order to distinguish the monochromatic CE signal from the background. 
A straw tube tracker will be used, adopting drift tube technology. 
Its distinctive annular geometry is highly effective in reducing background. 
The Mu2e straw tracker is placed inside the DS, downstream from the ST, 
in a uniform 1 T magnetic field. The detector has a modular design, consisting of basic elements referred to as 
$Panels$, $Faces$, $Planes$, and $Stations$. The tracker is composed of panels that contain arrays of 96 straw tubes, 
which serve as the sensitive units, arranged like the harp chords. The tracker will consist of 18 stations, 
each with 2 planes, each plane with 2 faces, and each face with three panels.

This Thesis has provided a comprehensive examination of the Mu2e tracker 
system, covering from its initial stages of commissioning to the optimization 
of DAQ and FEE and preliminary calibration steps. My work at Fermilab 
focused on thorough testing of the DAQ system from both hardware and 
software perspectives, and included involvement in the Vertical Slice Test (VST) of the tracker. 
The VST encompasses the entire testing chain, from the straws to the readout, to processed data on disk.
Throughout the chapters, we explored critical aspects of the tracker 
system, focusing on the robustness and reliability of data acquisition 
processes and the crucial role of calibration in ensuring precise measurements. 
In the latter part of my work, I concentrated on the offline analysis, particularly on pre-pattern recognition 
studies, investigating the optimal methods for flagging $\delta$-electrons during 
data taking. I conducted the first systematic study comparing the performance 
of two algorithms to determine the best approach for data-taking.
\section{Commissioning of the tracker DAQ and FEE}
The commissioning of the tracker DAQ and FEE systems, described in Chapter 
\ref{commissioning}, has been a crucial step in validating the functionality 
and performance of the readout chain.

The first test I performed was to verify the correct functioning of 
ROC buffering and to understand its logic. During these tests, a single 
ROC was connected to one DTC. Data were collected with digi-FPGAs pulsed 
by their internal pulsers, with the ROC set in external mode. The ROC's  
readout logic can be emulated with a bit-level C++ simulation, which I 
contributed to develop. The Monte Carlo simulation and the experimental 
data were compared in two different modes: \textit{ROC buffer underflow} and \textit{overflow} 
configuration. These configurations depend on the internal hit buffer, which stores up to 255 hits, 
and, depending on \( T_{gen} \) and \( T_{EW} \), the total number of hits within the event window can be respectively 
less than or equal to 255. 
By studying the timing distribution and delays between channels and digi-FPGAs, we 
were able to incorporate realistic delays into the simulation. The comparison 
between the data and the bit-level simulation demonstrated good agreement, 
validating the simulation's accuracy in reproducing the expected ROC behavior under 
the two ROC buffer modes. The agreement between the simulation and 
experimental data was highly satisfactory, with deviations at the level of \( 10^{-3} \).

The second test focused on evaluating the performance of preamplifiers, 
particularly looking for inactive channels, cross-talk between channels, 
and unexpected pulse patterns. The first part of the test examined channel occupancy, revealing 
dead channels and channels exhibiting a higher number of hits than expected. 
Cross-talk was observed in only the first channels, with an asymmetry in interference 
between odd and even channels. This phenomenon was attributed to the physical proximity 
of preamplifiers on the motherboard and the closeness of the first channels to each other. 
Although cross-talk was not fully resolved at the time of writing, further investigations 
are ongoing with tracker experts.
Subsequent waveform analysis helped explain abnormalities, particularly the inverted 
waveforms observed in some channels, which indicated the erroneous triggering of waveform 
on both the leading and trailing edges. The waveform analysis 
provided further insights into the charge and pulse height distributions, showing two or 
three peaks in their distribution. This was due to timing mismatches between the pulser 
and ADC, leading to incorrect readings. Overall, these tests provided valuable results 
that will inform future improvements to the preamplifier design and its integration into 
the readout chain. They also laid the foundations for the development of real-time 
diagnostic tools, along with the identification of key performance issues.

In summary, this commissioning phase successfully validated the core functionalities 
of the tracker DAQ and FEE systems, ensuring they are ready for the next stages of 
testing and integration. The insights gained, particularly in handling ROC overflow 
and timing synchronization, will be essential for optimizing the system's performance 
during full detector operation. Further work will focus on expanding the scope of 
testing with more complex configurations and refining the DAQ software for future runs.


\section{First steps towards the station calibration}
Chapter \ref{planning} outlines the initial steps towards calibrating the 
tracker. Our primary objective is to carry out a time calibration of 
the first assembled station using cosmic muons, with the aim of achieving 
a longitudinal hit position resolution better than 4 cm. This process 
requires determining the signal propagation velocity and channel-to-channel delays. 
Due to technical constraints, the first option involves calibrating with a 
vertically oriented station. I conducted a Monte Carlo study to evaluate the 
impact of this orientation on the calibration quality, particularly regarding 
cosmic track reconstruction and potential biases.

When a charged particle passes through the straw tube gas volume, the 
resulting ionization charge generates an electric signal along the anode wire, 
which propagates to both ends of the straw and reaches the front-end electronics, 
where TDCs measure the signal arrival times, $t_1$ and $t_2$. The primary 
goal of time calibration is to determine the track position along the straw 
by measuring these arrival times. Specifically, $\Delta t_{12} = t_1 - t_2$ determines 
the coordinate $x_{\text{track}}$, while $(t_1 + t_2)/2$ measures the drift time, 
up to a common offset for all channels.

My task was to reconstruct $x_{\text{track}}$ using only the information of 
whether a straw was crossed by a cosmic muon. The only way to deduce $x_{\text{track}}$ 
from this "yes-no" information is to use the geometry of the tracker station, 
which consists of a set of rotated panels arranged on four faces orthogonal 
to the detector axis. Since the Mu2e collaboration considered that a vertical station 
calibration might be feasible for our goals, due to operational constraints of the 
station, such as gas distribution, fragility, and space, I examined the potential 
biases and systematic errors that might result from this orientation.

The first step in my analysis involved determining the selection criteria for 
muons crossing a station and then assessing the illumination of the panels based 
on these selections. The illumination was non-uniform, with almost no hits 
in the central region of the panel, potentially leading to waveform non-linearities. 
Another critical factor was the cosmic event rate, which was computed to be approximately 
$R \sim 380$ Hz. Given that the expected calibration duration is around 6 days 
without interruptions, this is excessive for the simple calibration we aim to perform.

To reconstruct the 3D trajectory of the cosmic muon, at least 
two 3D points along its path are needed. The $x$ and $y$ coordinates 
of each point can be determined by the intersection of one pair of 
non-parallel straws. This analysis revealed that a vertical orientation 
for station calibration is not optimal, as the bias range spans approximately [-6, 6] cm. 
The 2D distribution of the longitudinal bias versus the true position shows four 
distinct spots along the $x$ axis, each corresponding to overlap regions of 
different straws. The TProfile indicated a systematic effect in determining 
the longitudinal position, with the range extending beyond [-4, 4] cm. 
This suggests that the mean is not a reliable estimator of the bias under 
these conditions, making the calibration process more challenging.

Consequently, an alternative orientation or method should be considered to 
optimize the calibration and achieve more accurate results. A new 
mechanical approach is currently under development to address the issues outlined. 
During the next months, the collaboration will perform the cosmic muon data-taking and 
the very first tracker calibration.
\section{Pre-pattern recognition studies}

Given the high data volume expected during Mu2e operations, 
estimated at approximately 7 PBytes per year, optimizing memory usage 
and minimizing CPU consumption are critical. One significant challenge 
is effectively flagging $\delta$-electron hits, which are the primary source 
of hits in the tracker, without compromising the efficiency of CE hit detection and 
track reconstruction. $\delta$-electrons originate from Compton scattered electrons, 
pair production electrons and positrons, and delta rays. Compton scattered electrons 
are produced when photons from neutron capture interact with the detector material, 
typically having energies of a few MeV. Pair production electrons and positrons 
are generated during nuclear recoil processes, and delta rays are produced 
when high-energy charged particles collide with the detector material.

A detailed study of pre-pattern recognition and a comparison of two algorithms for 
$\delta$-electron flagging is provided in Chapter \ref{delta} to address this issue. 
There are multiple reasons for conducting this study. First, Mu2e's primary goal is 
to detect the CE signal; flagging even a small fraction of hits generated 
by the CE as $\delta$-electrons may reduce the CE track reconstruction efficiency. 
Second, misidentifying muons and pions as protons or $\delta$-electrons 
can result in inaccurate background estimates. Moreover, counting the 
number of protons will complement the STM in determining the muon stopping rate. 
Simulations show that the majority (approximately 75\%) of hits in the tracker 
are generated by $\delta$-electrons, i.e., electrons and positrons with momenta below 20 MeV/c.

Two distinct algorithms have been developed in Mu2e Offline to identify 
and exclude these hits from the reconstruction process: $FlagBkgHits$ and $DeltaFinder$. 
The $FlagBkgHits$ algorithm clusters hits initially and uses an ANN to classify them, 
while $DeltaFinder$ identifies clusters of hits consistent with those produced by 
low-momentum particles. Based on the mean energy deposited by a $seed$ in a station, 
hits with energy above 5 keV are considered proton hits, while $FlagBkgHits$ lacks the 
capability to identify proton hits.

I conducted a systematic, two-level comparison of the performance of the two algorithms:
\begin{enumerate}
    \item \textbf{hit-level comparison}: this evaluates the accuracy 
    of individual hit flagging, providing a direct method to compare 
    the algorithms' performance. In terms of $\delta$-electron flagging, 
    both algorithms perform similarly. However, $DeltaFinder$ performs 
    better in flagging positrons due to the low statistics at energies 
    below 2 MeV/c. This presents a disadvantage for $FlagBkgHits$ since 
    its ANN depends on statistics, and it struggles to reconstruct hits 
    that register only a single hit per station. $FlagBkgHits$ flags 
    approximately 70\% more CE hits than $DeltaFinder$, as it analyzes the $x-y$ 
    plane and does not reconstruct hits in the z-coordinate. Additionally, $DeltaFinder$ 
    can flag proton hits (approximately 84\%), a task that $FlagBkgHits$ cannot perform. 
    It is crucial that hits corresponding to $p\bar{p}$ annihilation 
    are not flagged. $FlagBkgHits$ has been trained on datasets lacking 
    muon and pion hits and thus flags these particles at rates roughly 
    4 and 3.3 times higher, respectively, than $DeltaFinder$;

\item  \textbf{high-level comparison}: this assesses the algorithms' impact on 
subsequent event reconstruction stages, particularly how each contributes to accurate 
track reconstruction. The main difference between the two algorithms is in the number 
of reconstructed tracks using CE data samples, which is 16\% higher for $FlagBkgHits$. 
This increase is due to $FlagBkgHits$ failing to flag protons properly, allowing these 
particles to be sent to the reconstruction stage. The difference in the reconstruction of $p\bar{p}$ 
events, measured as the fraction of events with at least two reconstructed tracks, is approximately 22\% higher with $DeltaFinder$.
\end{enumerate}

An important aspect of the study was the timing performance of the two algorithms. 
For $FlagBkgHits$, it was necessary to account for the time spent creating the $StereoHit$s, 
while $DeltaFinder$ independently reconstructed the $seed$s. The timing performance was 
studied across all data samples, revealing that the difference in processing time between 
the two algorithms is negligible (with $FlagBkgHits$ having an advantage of less than 1 ms), 
considering that the entire reconstruction process takes only a few ms per event.

The primary drawback of $FlagBkgHits$ is its reliance on supervised training using 
CE and $\delta$-electron samples. This approach falters when other particles, such 
as cosmic muons and those from $p\bar{p}$ annihilation, are introduced into the algorithm. 
Furthermore, the training was conducted using Monte Carlo data rather than real data, 
posing a potential risk when transitioning to actual data-taking. Additionally, as an 
ANN-based method, $FlagBkgHits$ performs poorly when statistics are very low and lacks 
a well-defined method for proton flagging.
